# KION ML Recommender - –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

**–§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** MAP@10 = **0.082345** (50/80 –±–∞–ª–ª–æ–≤)

**–û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ:** –ê–Ω—Å–∞–º–±–ª—å –∏–∑ —Ç—Ä–µ—Ö –º–æ–¥–µ–ª–µ–π
- Popular (83%) + EASE (10%) + BPR (7%)

## üéØ –ó–∞–¥–∞–Ω–∏–µ

–°–æ–∑–¥–∞—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—É—é —Å–∏—Å—Ç–µ–º—É –¥–ª—è –≤–∏–¥–µ–æ—Å–µ—Ä–≤–∏—Å–∞ KION —Å —Ü–µ–ª—å—é:
- –ú–∏–Ω–∏–º—É–º: MAP@10 ‚â• 0.071 –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –±–∞–ª–ª–æ–≤
- –ú–∞–∫—Å–∏–º—É–º: MAP@10 ‚â• 0.089 –¥–ª—è –ø–æ–ª–Ω—ã—Ö 80 –±–∞–ª–ª–æ–≤
- Baseline (EASE): MAP@10 = 0.033

## üî¨ –ü—Ä–æ—Ü–µ—Å—Å —Ä–µ—à–µ–Ω–∏—è

### –≠—Ç–∞–ø 1: –ò–∑—É—á–µ–Ω–∏–µ baseline
–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (EASE –º–æ–¥–µ–ª—å) - MAP@10 = 0.033

### –≠—Ç–∞–ø 2: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–¥–∏–Ω–æ—á–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π (optimize_solution.py)
–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª 7 —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–æ–≤:

| –ú–æ–¥–µ–ª—å | MAP@10 | –í—Ä–µ–º—è |
|--------|--------|-------|
| BPR | 0.034 | 10s |
| Simple ALS | 0.023 | 7s |
| EASE Optimized | 0.023 | 29s |
| ALS High Factors | 0.022 | 34s |
| PureSVD | 0.020 | 1s |

**–í—ã–≤–æ–¥:** –í—Å–µ –º–æ–¥–µ–ª–∏ –¥–∞—é—Ç –Ω–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ (< 0.04)

### –≠—Ç–∞–ø 3: –ü–æ–∏—Å–∫ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–æ–≤ (optimize_solution_v2.py)
–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª 10 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Å —É–ø—Ä–æ—â–µ–Ω–Ω—ã–º –≤–∑–≤–µ—à–∏–≤–∞–Ω–∏–µ–º:

**–ü—Ä–æ—Ä—ã–≤!** PopularModel –¥–∞–ª MAP@10 = **0.078** (31/80 –±–∞–ª–ª–æ–≤)

–ö–ª—é—á–µ–≤–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ: –¥–ª—è –¥–∞–Ω–Ω–æ–π –∑–∞–¥–∞—á–∏ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å –≤–∞–∂–Ω–µ–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏

### –≠—Ç–∞–ø 4: –£–ª—É—á—à–µ–Ω–∏–µ Popular —á–µ—Ä–µ–∑ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ (optimize_solution_v3.py)
–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–ª –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ –∫ Popular:

| –ü–æ–¥—Ö–æ–¥ | MAP@10 | –ë–∞–ª–ª—ã |
|--------|--------|-------|
| Popular 90% + EASE 10% | **0.081** | 44/80 |
| Popular 70% + EASE 30% | 0.079 | 34/80 |
| Popular Recent Only | 0.079 | 34/80 |
| Popular Baseline | 0.078 | 31/80 |

**–£–ª—É—á—à–µ–Ω–∏–µ:** +0.003 –∑–∞ —Å—á–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏—è EASE

### –≠—Ç–∞–ø 5: –¢–æ–Ω–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–ø–æ—Ä—Ü–∏–π (optimize_solution_v4.py)
–í–∞—Ä—å–∏—Ä–æ–≤–∞–ª —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è Popular/EASE –∏ –¥–æ–±–∞–≤–ª—è–ª —Ç—Ä–µ—Ç—å—é –º–æ–¥–µ–ª—å:

| –ü–æ–¥—Ö–æ–¥ | MAP@10 | –ë–∞–ª–ª—ã |
|--------|--------|-------|
| Pop 85% + EASE 10% + BPR 5% | **0.082** | 48/80 |
| Popular 90% + EASE 10% k=30 | 0.081 | 44/80 |
| Popular 88% + EASE 12% | 0.081 | 44/80 |

**–£–ª—É—á—à–µ–Ω–∏–µ:** +0.001 –∑–∞ —Å—á–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏—è BPR

### –≠—Ç–∞–ø 6: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ç—Ä–µ—Ç—å–µ–π –º–æ–¥–µ–ª–∏ (optimize_solution_v5.py)
–§–∏–Ω–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–µ—Å–æ–≤ BPR –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤:

| –ü–æ–¥—Ö–æ–¥ | MAP@10 | –ë–∞–ª–ª—ã |
|--------|--------|-------|
| **Pop 83% + EASE 10% + BPR 7%** | **0.082345** | **50/80** ‚úÖ |
| Pop 85% + EASE 10% + BPR 5% | 0.081920 | 48/80 |
| Pop 87% + EASE 10% + BPR 3% | 0.081750 | 47/80 |
| Pop 85% + EASE 12% + BPR 3% | 0.081650 | 46/80 |

**–§–∏–Ω–∞–ª—å–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ:** +0.0004 –∑–∞ —Å—á–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –≤–µ—Å–æ–≤

## üìà –ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ –∏—Ç–µ—Ä–∞—Ü–∏—è–º

```
V1: MAP 0.034 (BPR)                    ‚Üí Baseline –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
V2: MAP 0.078 (Popular)                ‚Üí –ü—Ä–æ—Ä—ã–≤! +130%
V3: MAP 0.081 (Pop + EASE)             ‚Üí +3.8%
V4: MAP 0.082 (Pop + EASE + BPR)       ‚Üí +1.2%
V5: MAP 0.082345 (–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤–µ—Å–æ–≤)   ‚Üí +0.5% ‚úÖ
```

**–û–±—â–µ–µ —É–ª—É—á—à–µ–Ω–∏–µ:** –æ—Ç 0.033 –¥–æ 0.082 = **+149%**

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è

### –ê–Ω—Å–∞–º–±–ª—å –∏–∑ 3 –º–æ–¥–µ–ª–µ–π:

1. **PopularModel (83% –≤–µ—Å)**
   - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç —Å–∞–º—ã–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ items
   - –û—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏ –æ—Ö–≤–∞—Ç

2. **EASE (10% –≤–µ—Å)**
   - Collaborative filtering —á–µ—Ä–µ–∑ –º–∞—Ç—Ä–∏—á–Ω–æ–µ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ
   - –†–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è = 800 (–æ–ø—Ç–∏–º–∞–ª—å–Ω–∞—è)
   - –î–æ–±–∞–≤–ª—è–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ —Å—Ö–æ–∂–µ—Å—Ç—å items

3. **BPR (7% –≤–µ—Å)**
   - Bayesian Personalized Ranking
   - 100 —Ñ–∞–∫—Ç–æ—Ä–æ–≤, 50 –∏—Ç–µ—Ä–∞—Ü–∏–π
   - –î–æ–±–∞–≤–ª—è–µ—Ç –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è

### –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:
- –ü–æ–ª—É—á–∞–µ–º top-30 –æ—Ç –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏
- –í–∑–≤–µ—à–∏–≤–∞–µ–º –ø–æ —Ä–∞–Ω–≥—É: score = (30 - rank) √ó weight
- –°—É–º–º–∏—Ä—É–µ–º scores –¥–ª—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö user-item –ø–∞—Ä
- –í—ã–±–∏—Ä–∞–µ–º top-10 –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## üîë –ö–ª—é—á–µ–≤—ã–µ –∏–Ω—Å–∞–π—Ç—ã

1. **–ü–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å > –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è** 
   - –î–ª—è –≤–∏–¥–µ–æ-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –æ–±—â–∏–µ —Ç—Ä–µ–Ω–¥—ã –≤–∞–∂–Ω–µ–µ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã—Ö –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π
   - Popular –º–æ–¥–µ–ª—å –¥–∞–µ—Ç 78% –∏—Ç–æ–≥–æ–≤–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞

2. **–ê–Ω—Å–∞–º–±–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç**
   - –ö–æ–º–±–∏–Ω–∞—Ü–∏—è –∏–∑ 3 –º–æ–¥–µ–ª–µ–π –¥–∞–µ—Ç +5% –∫ —á–∏—Å—Ç–æ–º—É Popular
   - –í–∞–∂–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –≤–µ—Å–æ–≤ (83/10/7)

3. **–ê–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–µ –≤–∑–≤–µ—à–∏–≤–∞–Ω–∏–µ –≤—Ä–µ–¥–∏—Ç**
   - –ü–æ–ø—ã—Ç–∫–∏ —Å–∏–ª—å–Ω–æ –≤–∑–≤–µ—à–∏–≤–∞—Ç—å –ø–æ `watched_pct` —É—Ö—É–¥—à–∞–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
   - –ü—Ä–æ—Å—Ç–æ–π weight=1 —Ä–∞–±–æ—Ç–∞–µ—Ç –ª—É—á—à–µ

4. **Rank-based scoring —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–∞–Ω–≥–∞ –≤–º–µ—Å—Ç–æ —Å—ã—Ä—ã—Ö scores –∏–∑–±–µ–≥–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º —Å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–µ–π
   - Formula: `score = (k - rank) √ó model_weight`

## üì¶ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

```bash
pip install implicit==0.7.2 "rectools[all]==0.17.0" pandas==2.3.3 numpy==2.3.3 scipy==1.16.2 requests==2.32.5 catboost==1.2.8 scikit-learn==1.7.2
```

## üöÄ –ó–∞–ø—É—Å–∫

```python
python optimize_solution_v5.py  # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
```

–ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ `recsys_project_upd.ipynb` –Ω–∞–ø—Ä—è–º—É—é.

## ‚è±Ô∏è –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- –í—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è: ~34 —Å–µ–∫—É–Ω–¥—ã
- –í—Ä–µ–º—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞: ~1 —Å–µ–∫—É–Ω–¥–∞
- Total runtime: ~35 —Å–µ–∫—É–Ω–¥

–£–∫–ª–∞–¥—ã–≤–∞–µ–º—Å—è –≤ –ª–∏–º–∏—Ç 20 –º–∏–Ω—É—Ç —Å –±–æ–ª—å—à–∏–º –∑–∞–ø–∞—Å–æ–º ‚úÖ

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
kion-ml-recommender/
‚îú‚îÄ‚îÄ recsys_project_upd.ipynb          # –û—Å–Ω–æ–≤–Ω–æ–π –Ω–æ—É—Ç–±—É–∫ —Å —Ä–µ—à–µ–Ω–∏–µ–º
‚îú‚îÄ‚îÄ optimize_solution.py               # V1: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π
‚îú‚îÄ‚îÄ optimize_solution_v2.py            # V2: –ü–æ–∏—Å–∫ Popular baseline
‚îú‚îÄ‚îÄ optimize_solution_v3.py            # V3: Popular + –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è
‚îú‚îÄ‚îÄ optimize_solution_v4.py            # V4: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–µ—Ç—å–µ–π –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ optimize_solution_v5.py            # V5: –§–∏–Ω–∞–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
‚îú‚îÄ‚îÄ theory/                            # –ú–∞—Ç–µ—Ä–∏–∞–ª—ã —Å–µ–º–∏–Ω–∞—Ä–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ Practice3_MF_ANN.ipynb
‚îÇ   ‚îî‚îÄ‚îÄ Seminar_NN_ipynb_.ipynb
‚îî‚îÄ‚îÄ data_original/                     # –î–∞—Ç–∞—Å–µ—Ç KION
```

## üéì –í—ã–≤–æ–¥—ã

–£—Å–ø–µ—à–Ω–æ —É–ª—É—á—à–∏–ª–∏ baseline —Å MAP@10 = 0.033 –¥–æ 0.082 (+149%), –ø–æ–ª—É—á–∏–≤ **50/80 –±–∞–ª–ª–æ–≤**.

–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã —É—Å–ø–µ—Ö–∞:
1. –°–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ 40+ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
2. –û—Ç–∫—Ä—ã—Ç–∏–µ –≤–∞–∂–Ω–æ—Å—Ç–∏ Popular –º–æ–¥–µ–ª–∏
3. –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π
4. –¢–æ–Ω–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–µ—Å–æ–≤

---

**–ê–≤—Ç–æ—Ä —Ä–µ—à–µ–Ω–∏—è:** AI Assistant
**–î–∞—Ç–∞:** –û–∫—Ç—è–±—Ä—å 2025

